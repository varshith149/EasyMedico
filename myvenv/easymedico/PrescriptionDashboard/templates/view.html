<!DOCTYPE html>
<html lang="en">
<title>PRESCRIPTION DETAILS</title>
<head>
  <meta charset="UTF8">
  
   {% load static %}
   <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}"/>
   <link rel="stylesheet" type="text/css" href="{% static 'DataTables/DataTables-1.10.22/css/dataTables.bootstrap4.min.css' %}"/>
   
   <link rel="stylesheet" type="text/css" href="{% static 'DataTables/Buttons-1.6.5/css/buttons.bootstrap4.min.css' %}"/>
   <script type="text/javascript" src="{% static 'jquery-3.5.1.min.js' %}"></script> 
   <script type="text/javascript" src="{% static 'DataTables/DataTables-1.10.22/js/jquery.dataTables.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/DataTables-1.10.22/js/dataTables.bootstrap4.min.js' %}"></script>
   
   <link rel="stylesheet" type="text/css" href="{% static 'DataTables/Buttons-1.6.5/css/buttons.dataTables.min.css' %}"/>
   <script type="text/javascript" src="{% static 'DataTables/JSZip-2.5.0/jszip.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/pdfmake-0.1.36/pdfmake.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/pdfmake-0.1.36/vfs_fonts.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/Buttons-1.6.5/js/dataTables.buttons.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/Buttons-1.6.5/js/buttons.colVis.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/Buttons-1.6.5/js/buttons.flash.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/Buttons-1.6.5/js/buttons.html5.min.js' %}"></script>
   <script type="text/javascript" src="{% static 'DataTables/Buttons-1.6.5/js/buttons.print.min.js' %}"></script>
   <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>-->
   <style>
        .logout_btn {
            position: absolute;
            width: 100px;
            right: 4px;
            top: 8px;
            background: white !important;
            color: #ff0404 !important;
            font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
        }
        body{ 
            background-color:#28C2FF;

        }
        .clickable-row:hover td{
            background: #b4bdce;
            
        }
        a{
           font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
        }




   </style>
</head>
<body>
    <div>
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-link" style="background: #9EA8BA;border-color: white;">
                <a href="#tab-table1" data-toggle="tab" style="color: white;">Prescription Details</a>
            </li>
            <li class="nav-link"  style="background: #9EA8BA;border-color: white;">
                <a href="#tab-table2" data-toggle="tab" style="color: white;">Drug Details</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="tab-table1">
                <table id="myTable" class="table table-striped table-bordered table-sm" style="background-color:#9EA8BA;">
                    <thead  style="background-color:#52555a;color: white;">
                        
                        <tr>
                            <th>PRESCRIPTION ID</th>
                            <th>IMAGE</th>
                            <th>IMAGE UPLOAD DATE</th>
                            <th>IMAGE UPLOAD TIME</th>
                            <th>SALESPERSON EMAIL</th>
                            <th>ADDRESS</th>
                            <th>BRANCH CODE</th>
                            <th style="width: 150px;">DRUG NAME - REQUIRED QUANTITY</th>
                            

                            

                            
                    
                    
                        </tr>
                    </thead>
                    <tbody>
                        {% for image in imagedata %}
                                  
                        <tr class='clickable-row' data-href="{% url 'Image_popup' value=image.Image_ID %}">
                            <td>{{ image.Image_ID }}</td>
                            <td>{% load thumbnail %}
                                {% thumbnail image.Image_URL "200x200" as im %}
                                <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}">
                                {% endthumbnail %}
                            </td>
                            <td>{{ image.IMAGE_UPLOAD_DATE|date:'Y-m-d' }}</td>
                            <td>{{ image.IMAGE_UPLOAD_TIME|time:'H:i:s' }}</td>
                            <td>{{ image.USER_ID.EMAIL_ID }}</td>
                            <td>{{ image.USER_ID.ADDRESS }}</td>
                            <td>{{ image.USER_ID.BRANCHCODE }}</td>
                            <td>{% for drug in image.drugdetails_set.all %}
                                {{ drug.DRUG_NAME}}  -  {{drug.DRUG_REQ_QTY}}</br>
                            {% endfor %}</td>

                            

                        </tr>
                        {% endfor %}
                        

                    </tbody>
                    <tfoot>
                        <tr>
                            <th>PRESCRIPTION ID</th>
                            <th></th>
                            <th>IMAGE UPLOAD DATE</th>
                            <th>IMAGE UPLOAD TIME</th>
                            <th>SALESPERSON EMAIL</th>
                            <th>ADDRESS</th>
                            <th>BRANCH CODE</th>
                            <th>DRUG DETAILS</th>
                                            
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="tab-pane" id="tab-table2">
                <table id="myTable2" class="table table-striped table-bordered table-sm" style="background-color:#9EA8BA;width: 100%;">
                    <thead style="background-color:#52555a;color: white;">
                        <tr>
                            <th>PRESCRIPTION ID</th>
                            <th>DRUG NAME</th>
                            <th>DRUG QUANTITY</th>        
                    
                        </tr>
                    </thead>
                    <tbody>
                        {% for drug in drugdata %}
                        <tr>
                            <td>{{ drug.PRESCRIPTION_ID.Image_ID }}</td>
                            <td>{{ drug.DRUG_NAME }}</td>
                            <td>{{ drug.DRUG_REQ_QTY }}</td>
                        </tr>
                        {% endfor %}

                    </tbody>
                    <tfoot>
                        <tr>
                            <th>PRESCRIPTION ID</th>
                            <th>DRUG NAME</th>
                            <th>DRUG QUANTITY</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>


<script>
$(document).ready(function() {
    $('a[data-toggle="tab"]').on( 'shown.bs.tab', function (e) {
        $($.fn.dataTable.tables(true)).DataTable()
        .columns.adjust()
        .responsive.recalc();
    } );
    $(".clickable-row").click(function() {
        window.location = $(this).data("href");
    });
    $('#myTable2 tfoot th').each( function () {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="'+title+'" />' );
    } );
    $('#myTable tfoot th').each( function () {
        var title = $(this).text();
        if (!(title === '')) {
        $(this).html( '<input type="text" placeholder="'+title+'" />' );
        }
    } );
    var buttonCommon = {
        exportOptions: {
            format: {
                body: function ( data, row, column, node ) {
                    // Strip $ from salary column to make it numeric
                    return column === 7 ?
                        data.replace( /<br\s*\/?>/img, "\n"):
                        data;
                }
            }
        }
    };




   
    // DataTable 1
    var table = $('#myTable').DataTable({
        dom: 'Bfrtip',
        buttons: [
            $.extend( true, {}, buttonCommon, {
                extend: 'excel'
            } ),
            $.extend( true, {}, buttonCommon, {
                extend: 'csv'
            } )
        ],
        scrollY: 370,
        scrollX: 400,
        responsive: true,
        orderCellsTop: true,
        fixedHeader: true,
    
        

        
        


        initComplete: function () {
            // Apply the search
            this.api().columns().every( function () {
                var that = this;
 
                $( 'input', this.footer() ).on( 'keyup change clear', function () {
                    if ( that.search() !== this.value ) {
                        that
                            .search( this.value )
                            .draw();
                    }
                } );
            } );
        }
    });
    // DataTable 2
    var table = $('#myTable2').DataTable({
        dom: 'Bfrtip',
        buttons: [
             'csv', 'excel'
        ],
        scrollY: 370,
        scrollX: 400,
        responsive: true,
        

        
        
        

        initComplete: function () {
            // Apply the search
            this.api().columns().every( function () {
                var that = this;
 
                $( 'input', this.footer() ).on( 'keyup change clear', function () {
                    if ( that.search() !== this.value ) {
                        that
                            .search( this.value )
                            .draw();
                    }
                } );
            } );
        }
    });


 
} );

</script>


<button type="button" name="logout" class="logout_btn">
    <a href="{% url 'logout' %}" style="text-decoration:none">Logout</a>
</button>
    




</body>
</html>








